#### THIS IS FROM sarta_airsL2100, DONE APR 2025

#### ls -lt /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/dbase/Coef/
#### total 36
#### lrwxrwxrwx 1 chepplew pi_strow    91 Aug 27  2022 therm.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/thermFactor_airs_l1c_2834.dat
#### lrwxrwxrwx 1 chepplew pi_strow    94 Aug 26  2022 nh3.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_nh3_all.dat
#### lrwxrwxrwx 1 chepplew pi_strow    95 Aug 26  2022 hno3.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_hno3_all.dat
#### lrwxrwxrwx 1 chepplew pi_strow    94 Aug 29  2022 hdo.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_hdo_all.dat
#### lrwxrwxrwx 1 chepplew pi_strow    94 Aug 26  2022 n2o.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_n2o_all.dat
#### lrwxrwxrwx 1 chepplew pi_strow    94 Aug 26  2022 so2.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_so2_all.dat

#### lrwxrwxrwx 1 chepplew pi_strow   100 Aug 26  2022 nte.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_nte_all_7term.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Jun  1  2023 xnte.dat -> /home/chepplew//data/sarta/prod_2022/airs_l1c/apr2021/fitc/r49/AIRS_L1C_R49_cutcoef_xnte_2x7term.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Oct 17  2022 nte_7term.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/apr2021/fitc/r49/AIRS_L1C_R49_cutcoef_nte_all_7term.dat
#### -rwxrwxr-x 1 chepplew pi_strow 14760 Jun  1  2023 xnte_v02.dat
#### lrwxrwxrwx 1 chepplew pi_strow    77 Aug 25  2022 tunmlt.txt -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/tunmlt_ones.txt
#### -rwxrwxr-x 1 chepplew pi_strow 16338 Aug 25  2022 refprof_trace400
#### -rwxrwxr-x 1 chepplew pi_strow  2038 Aug 25  2022 fx.txt

#### lrwxrwxrwx 1 chepplew pi_strow    99 Aug 26  2022 optran.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_mergecoef_optran_fmw.dat
#### lrwxrwxrwx 1 chepplew pi_strow   105 Aug 25  2022 co2.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_co2_5term_fowp_sun.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Aug 25  2022 set7.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set7_fowp_sun.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Aug 25  2022 set5.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set5_fowp_sun.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Aug 25  2022 set6.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set6_fowp_sun.dat
#### lrwxrwxrwx 1 chepplew pi_strow   100 Aug 25  2022 set4.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set4_fcow_sun.dat
#### lrwxrwxrwx 1 chepplew pi_strow    95 Aug 25  2022 set3.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set3_fmw.dat
#### lrwxrwxrwx 1 chepplew pi_strow    96 Aug 25  2022 set2.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set2_fowp.dat
#### lrwxrwxrwx 1 chepplew pi_strow    96 Aug 25  2022 set1.dat -> /home/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_r49_cutcoef_set1_fowp.dat

########################################################################

# [sergio@chip ftc_dev]$ ls -lt /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/*cutcoef*
# -rw-rw-r-- 1 sergio pi_sergio  8161304 Aug  9 05:21 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_optran_fmw.dat
# -rw-rw-r-- 1 sergio pi_sergio  2181312 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_co2_5term_fowp_sun.dat
# -rw-rw-r-- 1 sergio pi_sergio  8155264 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_optran_fmw_nohdr.dat
#
# -rw-rw-r-- 1 sergio pi_sergio  1626240 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set7_fowp_sun.dat
# -rw-rw-r-- 1 sergio pi_sergio  1999872 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set6_fowp_sun.dat
# -rw-rw-r-- 1 sergio pi_sergio  1851360 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set5_fowp_sun.dat
# -rw-rw-r-- 1 sergio pi_sergio  1531360 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set4_fcow_sun.dat
# -rw-rw-r-- 1 sergio pi_sergio  5550336 Aug  8 15:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set3_fmw.dat
# -rw-rw-r-- 1 sergio pi_sergio  4685200 Aug  8 15:02 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set2_fowp.dat
# -rw-rw-r-- 1 sergio pi_sergio 18139776 Aug  8 15:02 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set1_fowp.dat
# 
# [sergio@chip ftc_dev]$ ls -lt /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/*.dat
# -rw-rw-r-- 1 sergio pi_sergio  113360 Aug  8 23:52 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/thermFactor_airs_l1c_2834.dat
# -rw-rw-r-- 1 sergio pi_sergio 2297952 Aug  9 09:03 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_nh3_all.dat
# -rw-rw-r-- 1 sergio pi_sergio 2605440 Aug  9 04:51 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_hdo_all.dat
# -rw-rw-r-- 1 sergio pi_sergio  618928 Aug  9 00:36 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_hno3_all.dat
# -rw-rw-r-- 1 sergio pi_sergio 1650176 Aug  8 17:17 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_n2o_all.dat
# -rw-rw-r-- 1 sergio pi_sergio  972832 Aug  8 16:45 /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_so2_all.dat
# 
########################################################################

echo "making L2_100/AIRS/2025/SAF703 links ...."
cd L2_100/AIRS/2025/SAF703

rm xnte.dat;          ln -s /home/sergio/asl/s1/chepplew//data/sarta/prod_2022/airs_l1c/apr2021/fitc/r49/AIRS_L1C_R49_cutcoef_xnte_2x7term.dat      xnte.dat
rm xnte_v02.dat;      ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/dbase/Coef/xnte_v02.dat                 .
rm nte_7term.dat;     ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/apr2021/fitc/r49/AIRS_L1C_R49_cutcoef_nte_all_7term.dat      nte_7term.dat
rm nte.dat;           ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/AIRS_L1C_R49_cutcoef_nte_all_7term.dat      nte.dat

rm tunmlt.txt;        ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/fitc/r49/tunmlt_ones.txt                             tunmlt.txt
rm refprof_trace400;  ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/dbase/Coef/refprof_trace400             .
rm fx.txt;            ln -s /home/sergio/asl/s1/chepplew/data/sarta/prod_2022/airs_l1c/jul2022/dbase/Coef/fx.txt                       .

rm hdo.dat;           ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_hdo_all.dat          hdo.dat
rm therm.dat;         ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/thermFactor_airs_l1c_2834.dat               therm.dat
rm hno3.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_hno3_all.dat         hno3.dat
rm nh3.dat;           ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_nh3_all.dat          nh3.dat
rm so2.dat;           ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_so2_all.dat          so2.dat
rm n2o.dat;           ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/saf704/AIRS_L1C_SAF704_cutcoef_n2o_all.dat          n2o.dat
rm optran.dat;        ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_optran_fmw.dat         optran.dat
rm co2.dat;           ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_co2_5term_fowp_sun.dat co2.dat
rm set7.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set7_fowp_sun.dat      set7.dat
rm set6.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set6_fowp_sun.dat      set6.dat
rm set5.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set5_fowp_sun.dat      set5.dat
rm set4.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set4_fcow_sun.dat      set4.dat
rm set3.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set3_fmw.dat           set3.dat
rm set2.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set2_fowp.dat          set2.dat
rm set1.dat;          ln -s /asl/s1/sergio/alldata/ftcprod/prod_2025/airs_l1c/aug2025_saf703/fitc/r49/AIRS_L1C_SAF704_cutcoef_set1_fowp.dat          set1.dat

cd ../../../
echo "from /home/sergio/SARTA_CLOUDY_RTP_KLAYERS_NLEVELS/JACvers/srcF77_jac  test on chip using eg "
echo "     time ../bin/jac_airs_l1c_2834_cloudy_aug25_H2020_saf703 fin=../TEST_RTP/newdayx_1_100_12150.op.rtp fout=junk.rp.rtp"
echo "  "
echo "Compare against "
echo "     time ../bin/jac_airs_l1c_2834_cloudy_jan25_H2020       fin=../TEST_RTP/newdayx_1_100_12150.op.rtp fout=junk0.rp.rtp"
echo "     time ../bin/jac_airs_l1c_2834_cloudy_jul25_H2020_ecm83 fin=../TEST_RTP/newdayx_1_100_12150.op.rtp fout=junk1.rp.rtp"

########################################################################

## this is reading in above files to test

: <<'END_COMMENT'

ls -lt ../TEST_RTP
lrwxrwxrwx 1 sergio pi_sergio       133 Aug  9 16:53 regr49_1013_400ppm_unitemiss.op.rtp -> /home/sergio/MATLABCODE/REGR_PROFILES_SARTA/RUN_KCARTA/REGR49_400ppm_H2016_Feb2020_AIRS2834_CHIRP/regr49_1013_400ppm_unitemiss.op.rtp
lrwxrwxrwx 1 sergio pi_sergio       159 Aug  9 16:52 save_SAF_704_profiles__unitemis.op.rtp -> /home/sergio/MATLABCODE/REGR_PROFILES_SARTA/RUN_KCARTA/SAF704_400ppm_H2020_July2025/save_SAF_704_profiles_29-Apr-2016_1100mb_400ppmv_gas9_11_12_unitemis.op.rtp
lrwxrwxrwx 1 sergio pi_sergio       150 Aug  9 16:51 ecmwf83__co2_400ppm_1013mb.op.rtp -> /home/sergio/MATLABCODE/REGR_PROFILES_SARTA/RUN_KCARTA/REGR49_400ppm_H2020_July2025_ECMWF83Profiles_AIRS2834_3CrIS_IASI/ecmwf_co2_400ppm_1013mb.op.rtp
-

time ../bin/jac_airs_l1c_2834_cloudy_aug25_H2020_saf703 fin=../TEST_RTP/save_SAF_704_profiles__unitemis.op.rtp.op.rtp fout=junk.rp.rtp
time ../bin/jac_airs_l1c_2834_cloudy_jan25_H2020        fin=../TEST_RTP/save_SAF_704_profiles__unitemis.op.rtp.op.rtp fout=junk0.rp.rtp
time ../bin/jac_airs_l1c_2834_cloudy_jul25_H2020_ecm83  fin=../TEST_RTP/save_SAF_704_profiles__unitemis.op.rtp.op.rtp fout=junk1.rp.rtp


addpath /asl/matlib/aslutil
addpath /asl/matlib/h4tools

[hsaf703,ha,psaf703,pa] = rtpread('junk.rp.rtp');
[horig,ha,porig,pa] = rtpread('junk0.rp.rtp');
[horig,ha,pecm83,pa] = rtpread('junk1.rp.rtp');

tsaf703 = rad2bt(hsaf703.vchan,psaf703.rcalc);
torig = rad2bt(horig.vchan,porig.rcalc);
tecm83 = rad2bt(horig.vchan,pecm83.rcalc);

figure(1); plot(hsaf703.vchan,tsaf703);

figure(1); clf; plot(hsaf703.vchan,torig,'b',hsaf703.vchan,tecm83,'k',hsaf703.vchan,tsaf703,'r');
figure(2); clf; plot(hsaf703.vchan,tecm83 - torig,'b',hsaf703.vchan,tsaf703 - torig,'r');
figure(3); clf; plot(hsaf703.vchan,nanmean(tecm83' - torig'),'b',hsaf703.vchan,nanstd(tecm83' - torig'),'c',hsaf703.vchan,nanmean(tsaf703' - torig'),'r',hsaf703.vchan,nanstd(tsaf703' - torig'),'m');

figure(1); title('(r) saf703 (b) orig (k) ecm83')
figure(2); title('(b) ecm83-orig (r) saf703-orig')
figure(3); title('(b/c)ecm83 - orig (r/m)saf703-orig    mean,std'); ylim([-1 +1]*0.5)

figure(3); clf; tt = tiledlayout(2,1);
tt1 = nexttile;
plot(hsaf703.vchan,nanmean(tecm83' - torig'),'b',hsaf703.vchan,nanstd(tecm83' - torig'),'c'); ylabel('dBT(K) \newline ECM83'); axis([645 2780 -0.5 +0.5]); grid
tt2 = nexttile;
plot(hsaf703.vchan,nanmean(tsaf703' - torig'),'r',hsaf703.vchan,nanstd(tsaf703' - torig'),'m'); ylabel('dBT(K) \newline SAF703'); axis([645 2780 -0.5 +0.5]); grid

tt1.XTickLabel = '';
tt.TileSpacing = 'compact';
tt.Padding = 'compact';
END_COMMENT
